"use strict";(self.webpackChunksaba=self.webpackChunksaba||[]).push([[332],{8332:(V,A,c)=>{c.r(A),c.d(A,{AttemptModule:()=>X});var m=c(9808),d=c(3075),w=c(9487),u=c(4521),_=c(6066),t=c(5e3),O=c(4004),v=c(5830);let g=(()=>{class n{constructor(e){this.api=e}getAttempt(e,o){return this.api.get(`course/${e}/exam/${o}/attempt`).pipe((0,O.U)(i=>({id:i.id,name:i.name,creationDate:new Date(i.creationDate),attemptStatus:i.attemptStatus,answers:i.answers})))}beginAttempt(e,o){return this.api.post(`course/${e}/exam/${o}/attempt/begin`)}finishAttempt(e,o){return this.api.post(`course/${e}/exam/${o}/attempt/finish`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.s))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var C=c(2468),h=c(7423),b=c(5245),p=c(1125),I=c(773),x=c(9814);function y(n,s){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner"),t.qZA())}function M(n,s){1&n&&(t.TgZ(0,"div")(1,"h2",3)(2,"mat-icon"),t._uU(3,"info"),t.qZA(),t._uU(4," \u0622\u0632\u0645\u0648\u0646 \u06cc\u0627\u0641\u062a \u0646\u0634\u062f! "),t.qZA()())}function J(n,s){1&n&&(t.TgZ(0,"mat-icon",14),t._uU(1,"check"),t.qZA())}function Q(n,s){1&n&&(t.TgZ(0,"mat-icon",15),t._uU(1,"close"),t.qZA())}function F(n,s){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,J,2,0,"mat-icon",12),t.YNc(2,Q,2,0,"mat-icon",13),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.correctOption===e.selectedOption),t.xp6(1),t.Q6J("ngIf",e.correctOption!==e.selectedOption)}}function U(n,s){1&n&&(t.TgZ(0,"mat-icon",14),t._uU(1,"check"),t.qZA())}function Y(n,s){1&n&&(t.TgZ(0,"mat-icon",15),t._uU(1,"close"),t.qZA())}function S(n,s){1&n&&(t.TgZ(0,"mat-icon",19),t._uU(1,"check"),t.qZA())}function N(n,s){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,U,2,0,"mat-icon",12),t.YNc(2,Y,2,0,"mat-icon",13),t.YNc(3,S,2,0,"mat-icon",18),t.qZA()),2&n){const e=t.oxw().index,o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e===o.selectedOption&&e===o.correctOption),t.xp6(1),t.Q6J("ngIf",e===o.selectedOption&&e!==o.correctOption),t.xp6(1),t.Q6J("ngIf",e!==o.selectedOption&&e===o.correctOption)}}function q(n,s){if(1&n&&(t.TgZ(0,"mat-radio-button",16)(1,"span",17)(2,"b"),t._uU(3),t.qZA(),t._uU(4),t.YNc(5,N,4,3,"span",1),t.qZA()()),2&n){const e=s.$implicit,o=s.index,i=t.oxw().$implicit,a=t.oxw(2);t.Q6J("value",o),t.xp6(3),t.hij("",a.alphabeticalNumbering.getText(o),"."),t.xp6(1),t.hij("\xa0 ",e.text," "),t.xp6(1),t.Q6J("ngIf",null!==i.correctOption)}}function P(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",7),t.NdJ("opened",function(){const a=t.CHM(e).index,r=t.oxw(2);return t.KtG(r.currectQuestionIndex=a)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"b"),t._uU(4),t.qZA(),t._uU(5),t.YNc(6,F,3,2,"span",1),t.qZA()(),t.TgZ(7,"mat-radio-group",8),t.YNc(8,q,6,4,"mat-radio-button",9),t.qZA(),t.TgZ(9,"mat-action-row")(10,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex-1)}),t._uU(11," \u0642\u0628\u0644\u06cc "),t.qZA(),t.TgZ(12,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex+1)}),t._uU(13," \u0628\u0639\u062f\u06cc "),t.qZA()()()}if(2&n){const e=s.$implicit,o=s.index,i=t.oxw(2);t.Q6J("expanded",i.currectQuestionIndex===o),t.xp6(4),t.hij("",(o+1).toLocaleString("fa-IR"),"."),t.xp6(1),t.hij(" \xa0 ",e.text," "),t.xp6(1),t.Q6J("ngIf",null!==e.correctOption),t.xp6(1),t.Q6J("disabled",!0)("ngModel",e.selectedOption),t.xp6(1),t.Q6J("ngForOf",e.options),t.xp6(2),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===i.attempt.answers.length-1)}}function R(n,s){if(1&n&&(t.TgZ(0,"div")(1,"p",4),t._uU(2),t.qZA(),t.TgZ(3,"h2",5)(4,"span"),t._uU(5,"\u0646\u062a\u06cc\u062c\u0647 \u0622\u0632\u0645\u0648\u0646"),t.qZA(),t.TgZ(6,"small"),t._uU(7),t.qZA()(),t.TgZ(8,"mat-accordion"),t.YNc(9,P,14,9,"mat-expansion-panel",6),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name),t.xp6(5),t.AsE("",e.score.toLocaleString("fa-IR")," \u0627\u0632 ",e.totalScore.toLocaleString("fa-IR")," \u0646\u0645\u0631\u0647"),t.xp6(2),t.Q6J("ngForOf",e.attempt.answers)("ngForTrackBy",e.identify)}}let k=(()=>{class n{constructor(e,o,i,a){this.attemptService=e,this.route=o,this.router=i,this.alphabeticalNumbering=a,this.loading=!0,this.currectQuestionIndex=0,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.courseId=parseInt(e.get("courseId")),this.examId=parseInt(e.get("examId")),this.loadData(this.courseId,this.examId)}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe({next:i=>{this.attempt=i,this.loading=!1,i.attemptStatus!==_.I.inProgress&&this.router.navigate(["..",_.n[i.attemptStatus]],{relativeTo:this.route})},error:()=>{this.loading=!1}})}get score(){return this.attempt.answers.filter(e=>null!==e.correctOption&&e.correctOption===e.selectedOption).length}get totalScore(){return this.attempt.answers.filter(e=>null!==e.correctOption).length}identify(e,o){return o.id}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(u.gz),t.Y36(u.F0),t.Y36(C.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempt-result"]],decls:3,vars:3,consts:[["class","spinner-container",4,"ngIf"],[4,"ngIf"],[1,"spinner-container"],[1,"not-found","warn-text"],[1,"mat-display-2"],[1,"result-score"],[3,"expanded","opened",4,"ngFor","ngForOf","ngForTrackBy"],[3,"expanded","opened"],[1,"option-list",3,"disabled","ngModel"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","accent",3,"disabled","click"],["mat-button","","color","primary",3,"disabled","click"],["class","positive",4,"ngIf"],["class","negative",4,"ngIf"],[1,"positive"],[1,"negative"],[3,"value"],[1,"option-content"],["class","neutral",4,"ngIf"],[1,"neutral"]],template:function(e,o){1&e&&(t.YNc(0,y,2,0,"div",0),t.YNc(1,M,5,0,"div",1),t.YNc(2,R,10,5,"div",1)),2&e&&(t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.attempt),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.attempt))},dependencies:[m.sg,m.O5,d.JJ,d.On,h.lW,b.Hw,p.pp,p.ib,p.VG,p.yz,p.yK,I.Ou,x.VQ,x.U0],styles:["[_nghost-%COMP%]{display:grid}.spinner-container[_ngcontent-%COMP%]{display:grid;align-items:center;justify-items:center}.not-found[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.result-score[_ngcontent-%COMP%]{display:flex;gap:2rem}.warn-text[_ngcontent-%COMP%]{color:#f44336}.warn-text[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.option-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#000000de}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1rem}.positive[_ngcontent-%COMP%]{color:#673ab7}.neutral[_ngcontent-%COMP%]{color:#0000008a}.negative[_ngcontent-%COMP%]{color:#f44336}"]}),n})(),$=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempt"]],decls:1,vars:0,consts:[["hidden",""]],template:function(e,o){1&e&&t._UZ(0,"router-outlet",0)},dependencies:[u.lC],styles:["[_nghost-%COMP%]{display:grid}"]}),n})();var f=c(520);let T=(()=>{class n{constructor(e){this.api=e}putAnswer(e,o,i,a){return this.api.put(`course/${e}/exam/${o}/attempt/question/${i}/answer`,a)}deleteAnswer(e,o,i){return this.api.delete(`course/${e}/exam/${o}/attempt/question/${i}/answer`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.s))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var Z=c(7261);function B(n,s){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner"),t.qZA())}function E(n,s){1&n&&(t.TgZ(0,"div")(1,"h2",3)(2,"mat-icon"),t._uU(3,"info"),t.qZA(),t._uU(4," \u0622\u0632\u0645\u0648\u0646 \u06cc\u0627\u0641\u062a \u0646\u0634\u062f! "),t.qZA()())}function G(n,s){if(1&n&&(t.TgZ(0,"mat-radio-button",14)(1,"b"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&n){const e=s.$implicit,o=s.index,i=t.oxw(3);t.Q6J("value",o),t.xp6(2),t.hij("",i.alphabeticalNumbering.getText(o),"."),t.xp6(1),t.hij("\xa0 ",e.text," ")}}function j(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",8),t.NdJ("opened",function(){const a=t.CHM(e).index,r=t.oxw(2);return t.KtG(r.currectQuestionIndex=a)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"b"),t._uU(4),t.qZA(),t._uU(5),t.qZA()(),t.TgZ(6,"mat-radio-group",9),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.changeAnswer(r,i))}),t.YNc(7,G,4,3,"mat-radio-button",10),t.qZA(),t.TgZ(8,"mat-action-row")(9,"button",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.removeAnswer(a))}),t._uU(10," \u067e\u0627\u06a9 \u06a9\u0631\u062f\u0646 \u067e\u0627\u0633\u062e "),t.qZA(),t.TgZ(11,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex-1)}),t._uU(12," \u0642\u0628\u0644\u06cc "),t.qZA(),t.TgZ(13,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex+1)}),t._uU(14," \u0628\u0639\u062f\u06cc "),t.qZA()()()}if(2&n){const e=s.$implicit,o=s.index,i=t.oxw(2);t.Q6J("expanded",i.currectQuestionIndex===o),t.xp6(4),t.hij("",(o+1).toLocaleString("fa-IR"),"."),t.xp6(1),t.hij(" \xa0 ",e.text," "),t.xp6(1),t.Q6J("ngModel",e.selectedOption),t.xp6(1),t.Q6J("ngForOf",e.options),t.xp6(2),t.Q6J("disabled",null==e.selectedOption),t.xp6(2),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===i.attempt.answers.length-1)}}function z(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p",4),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"\u067e\u0631\u0633\u0634\u200c\u0647\u0627\u06cc \u0622\u0632\u0645\u0648\u0646"),t.qZA(),t.TgZ(5,"mat-accordion"),t.YNc(6,j,15,8,"mat-expansion-panel",5),t.qZA(),t.TgZ(7,"div",6)(8,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.finishAttempt())}),t._uU(9,"\u067e\u0627\u06cc\u0627\u0646 \u0622\u0632\u0645\u0648\u0646"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name),t.xp6(4),t.Q6J("ngForOf",e.attempt.answers)("ngForTrackBy",e.identify)}}let D=(()=>{class n{constructor(e,o,i,a,r,l){this.attemptService=e,this.answerService=o,this.route=i,this.router=a,this.snackBar=r,this.alphabeticalNumbering=l,this.loading=!0,this.currectQuestionIndex=0,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.courseId=parseInt(e.get("courseId")),this.examId=parseInt(e.get("examId")),this.loadData(this.courseId,this.examId)}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe({next:i=>{this.attempt=i,this.loading=!1,i.attemptStatus!==_.I.inProgress&&this.router.navigate(["..",_.n[i.attemptStatus]],{relativeTo:this.route})},error:()=>{this.loading=!1}})}changeAnswer(e,o){e.selectedOption=o,this.answerService.putAnswer(this.courseId,this.examId,e.id,o).subscribe({error:i=>{var a,r;if(i instanceof f.UA){const l=null!==(r=null===(a=i.error)||void 0===a?void 0:a.message)&&void 0!==r?r:"\u062e\u0637\u0627 \u062f\u0631 \u062b\u0628\u062a \u067e\u0627\u0633\u062e\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(l)}}})}removeAnswer(e){e.selectedOption=null,this.answerService.deleteAnswer(this.courseId,this.examId,e.id).subscribe({error:o=>{var i,a;if(o instanceof f.UA){const r=null!==(a=null===(i=o.error)||void 0===i?void 0:i.message)&&void 0!==a?a:"\u062e\u0637\u0627 \u062f\u0631 \u062d\u0630\u0641 \u067e\u0627\u0633\u062e\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(r)}}})}finishAttempt(){this.attemptService.finishAttempt(this.courseId,this.examId).subscribe({next:()=>this.router.navigate(["../result"],{relativeTo:this.route}),error:e=>{var o,i;if(e instanceof f.UA){const a=null!==(i=null===(o=e.error)||void 0===o?void 0:o.message)&&void 0!==i?i:"\u062e\u0637\u0627 \u062f\u0631 \u067e\u0627\u06cc\u0627\u0646 \u0622\u0632\u0645\u0648\u0646\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(a)}}})}showError(e){this.snackBar.open(e,void 0,{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"warn-snackbar"})}identify(e,o){return o.id}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(T),t.Y36(u.gz),t.Y36(u.F0),t.Y36(Z.ux),t.Y36(C.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempting"]],decls:3,vars:3,consts:[["class","spinner-container",4,"ngIf"],[4,"ngIf"],[1,"spinner-container"],[1,"not-found","warn-text"],[1,"mat-display-2"],[3,"expanded","opened",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attempt-action-row"],["mat-raised-button","","color","accent",3,"click"],[3,"expanded","opened"],[1,"option-list",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","warn",3,"disabled","click"],["mat-button","","color","accent",3,"disabled","click"],["mat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(e,o){1&e&&(t.YNc(0,B,2,0,"div",0),t.YNc(1,E,5,0,"div",1),t.YNc(2,z,10,3,"div",1)),2&e&&(t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.attempt),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.attempt))},dependencies:[m.sg,m.O5,d.JJ,d.On,h.lW,b.Hw,p.pp,p.ib,p.VG,p.yz,p.yK,I.Ou,x.VQ,x.U0],styles:["[_nghost-%COMP%]{display:grid}.spinner-container[_ngcontent-%COMP%]{display:grid;align-items:center;justify-items:center}.not-found[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.warn-text[_ngcontent-%COMP%]{color:#f44336}.warn-text[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1rem}.attempt-action-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;margin-top:2rem}"]}),n})();function H(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p",1),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4,"\u0634\u0645\u0627 \u0647\u0646\u0648\u0632 \u062f\u0631 \u0627\u06cc\u0646 \u0622\u0632\u0645\u0648\u0646 \u0634\u0631\u06a9\u062a \u0646\u06a9\u0631\u062f\u0647\u200c\u0627\u06cc\u062f."),t.qZA(),t.TgZ(5,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.beginAttempt())}),t._uU(6,"\u0634\u0631\u06a9\u062a \u062f\u0631 \u0622\u0632\u0645\u0648\u0646"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name)}}const K=[{path:"",component:$,children:[{path:"begin",component:(()=>{class n{constructor(e,o,i,a){this.attemptService=e,this.route=o,this.router=i,this.snackBar=a,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.loadData(parseInt(e.get("courseId")),parseInt(e.get("examId")))}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe(i=>{this.attempt=i,i.attemptStatus!==_.I.notAttempted&&this.router.navigate(["..",_.n[i.attemptStatus]],{relativeTo:this.route})})}beginAttempt(){const e=parseInt(this.route.snapshot.paramMap.get("courseId")),o=parseInt(this.route.snapshot.paramMap.get("examId"));this.attemptService.beginAttempt(e,o).subscribe({next:()=>this.router.navigate(["../inprogress"],{relativeTo:this.route}),error:i=>{var a,r;if(i instanceof f.UA){const l=null!==(r=null===(a=i.error)||void 0===a?void 0:a.message)&&void 0!==r?r:"\u062e\u0637\u0627 \u062f\u0631 \u0634\u0631\u0648\u0639 \u0622\u0632\u0645\u0648\u0646\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(l)}}})}showError(e){this.snackBar.open(e,void 0,{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"warn-snackbar"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(u.gz),t.Y36(u.F0),t.Y36(Z.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-begin-attempt"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"mat-display-2"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,H,7,1,"div",0),2&e&&t.Q6J("ngIf",o.attempt)},dependencies:[m.O5,h.lW]}),n})()},{path:"inprogress",component:D},{path:"result",component:k}]}];let L=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(K),u.Bz]}),n})(),X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[g,T],imports:[m.ez,d.u5,d.UX,w.q,L]}),n})()}}]);