"use strict";(self.webpackChunksaba=self.webpackChunksaba||[]).push([[332],{8332:(j,A,a)=>{a.r(A),a.d(A,{AttemptModule:()=>G});var l=a(9808),d=a(3075),y=a(9487),p=a(4521),g=a(6066),t=a(5e3),O=a(4004),v=a(5830);let _=(()=>{class n{constructor(e){this.api=e}getAttempt(e,o){return this.api.get(`course/${e}/exam/${o}/attempt`).pipe((0,O.U)(i=>({id:i.id,name:i.name,creationDate:new Date(i.creationDate),attemptStatus:i.attemptStatus,answers:i.answers})))}beginAttempt(e,o){return this.api.post(`course/${e}/exam/${o}/attempt/begin`)}finishAttempt(e,o){return this.api.post(`course/${e}/exam/${o}/attempt/finish`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.s))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var C=a(2468),h=a(7423),b=a(5245),c=a(1125),I=a(3737),T=a(773),x=a(9814);function M(n,s){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner"),t.qZA())}function F(n,s){1&n&&(t.TgZ(0,"div")(1,"h2",3)(2,"mat-icon"),t._uU(3,"info"),t.qZA(),t._uU(4," \u0622\u0632\u0645\u0648\u0646 \u06cc\u0627\u0641\u062a \u0646\u0634\u062f! "),t.qZA()())}function J(n,s){if(1&n&&(t.TgZ(0,"mat-radio-button",11)(1,"span",12)(2,"b"),t._uU(3),t.qZA(),t._uU(4),t.qZA()()),2&n){const e=s.$implicit,o=s.index,i=t.oxw(3);t.Q6J("value",o),t.xp6(3),t.hij("",i.alphabeticalNumbering.getText(o),"."),t.xp6(1),t.hij("\xa0 ",e.text," ")}}function Q(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",6),t.NdJ("opened",function(){const r=t.CHM(e).index,u=t.oxw(2);return t.KtG(u.currectQuestionIndex=r)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"b"),t._uU(4),t.qZA(),t._uU(5),t.qZA()(),t.TgZ(6,"mat-radio-group",7),t.YNc(7,J,5,3,"mat-radio-button",8),t.qZA(),t.TgZ(8,"mat-action-row")(9,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex-1)}),t._uU(10," \u0642\u0628\u0644\u06cc "),t.qZA(),t.TgZ(11,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex+1)}),t._uU(12," \u0628\u0639\u062f\u06cc "),t.qZA()()()}if(2&n){const e=s.$implicit,o=s.index,i=t.oxw(2);t.Q6J("expanded",i.currectQuestionIndex===o),t.xp6(4),t.hij("",(o+1).toLocaleString("fa-IR"),"."),t.xp6(1),t.hij(" \xa0 ",e.text," "),t.xp6(1),t.Q6J("disabled",!0)("ngModel",e.selectedOption),t.xp6(1),t.Q6J("ngForOf",e.options),t.xp6(2),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===i.attempt.answers.length-1)}}function U(n,s){if(1&n&&(t.TgZ(0,"div")(1,"p",4),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"\u0646\u062a\u06cc\u062c\u0647 \u0622\u0632\u0645\u0648\u0646"),t.qZA(),t.TgZ(5,"mat-accordion"),t.YNc(6,Q,13,8,"mat-expansion-panel",5),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name),t.xp6(4),t.Q6J("ngForOf",e.attempt.answers)("ngForTrackBy",e.identify)}}let S=(()=>{class n{constructor(e,o,i,r){this.attemptService=e,this.route=o,this.router=i,this.alphabeticalNumbering=r,this.loading=!0,this.currectQuestionIndex=0,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.courseId=parseInt(e.get("courseId")),this.examId=parseInt(e.get("examId")),this.loadData(this.courseId,this.examId)}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe({next:i=>{this.attempt=i,this.loading=!1,i.attemptStatus!==g.I.inProgress&&this.router.navigate(["..",g.n[i.attemptStatus]],{relativeTo:this.route})},error:()=>{this.loading=!1}})}identify(e,o){return o.id}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_),t.Y36(p.gz),t.Y36(p.F0),t.Y36(C.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempt-result"]],decls:3,vars:3,consts:[["class","spinner-container",4,"ngIf"],[4,"ngIf"],[1,"spinner-container"],[1,"not-found","warn-text"],[1,"mat-display-2"],["cdkDrag","",3,"expanded","opened",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",3,"expanded","opened"],[1,"option-list",3,"disabled","ngModel"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","accent",3,"disabled","click"],["mat-button","","color","primary",3,"disabled","click"],[3,"value"],[1,"normal-color"]],template:function(e,o){1&e&&(t.YNc(0,M,2,0,"div",0),t.YNc(1,F,5,0,"div",1),t.YNc(2,U,7,3,"div",1)),2&e&&(t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.attempt),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.attempt))},dependencies:[l.sg,l.O5,d.JJ,d.On,h.lW,b.Hw,c.pp,c.ib,c.VG,c.yz,c.yK,I.Zt,T.Ou,x.VQ,x.U0],styles:["[_nghost-%COMP%]{display:grid}.spinner-container[_ngcontent-%COMP%]{display:grid;align-items:center;justify-items:center}.not-found[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.warn-text[_ngcontent-%COMP%]{color:#f44336}.warn-text[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.normal-color[_ngcontent-%COMP%]{color:#000000de}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1rem}"]}),n})(),Y=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempt"]],decls:1,vars:0,consts:[["hidden",""]],template:function(e,o){1&e&&t._UZ(0,"router-outlet",0)},dependencies:[p.lC],styles:["[_nghost-%COMP%]{display:grid}"]}),n})();var f=a(520);let Z=(()=>{class n{constructor(e){this.api=e}putAnswer(e,o,i,r){return this.api.put(`course/${e}/exam/${o}/attempt/question/${i}/answer`,r)}deleteAnswer(e,o,i){return this.api.delete(`course/${e}/exam/${o}/attempt/question/${i}/answer`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(v.s))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var w=a(7261);function N(n,s){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner"),t.qZA())}function k(n,s){1&n&&(t.TgZ(0,"div")(1,"h2",3)(2,"mat-icon"),t._uU(3,"info"),t.qZA(),t._uU(4," \u0622\u0632\u0645\u0648\u0646 \u06cc\u0627\u0641\u062a \u0646\u0634\u062f! "),t.qZA()())}function P(n,s){if(1&n&&(t.TgZ(0,"mat-radio-button",14)(1,"b"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&n){const e=s.$implicit,o=s.index,i=t.oxw(3);t.Q6J("value",o),t.xp6(2),t.hij("",i.alphabeticalNumbering.getText(o),"."),t.xp6(1),t.hij("\xa0 ",e.text," ")}}function q(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",8),t.NdJ("opened",function(){const r=t.CHM(e).index,u=t.oxw(2);return t.KtG(u.currectQuestionIndex=r)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"b"),t._uU(4),t.qZA(),t._uU(5),t.qZA()(),t.TgZ(6,"mat-radio-group",9),t.NdJ("ngModelChange",function(i){const u=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.changeAnswer(u,i))}),t.YNc(7,P,4,3,"mat-radio-button",10),t.qZA(),t.TgZ(8,"mat-action-row")(9,"button",11),t.NdJ("click",function(){const r=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.removeAnswer(r))}),t._uU(10," \u067e\u0627\u06a9 \u06a9\u0631\u062f\u0646 \u067e\u0627\u0633\u062e "),t.qZA(),t.TgZ(11,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex-1)}),t._uU(12," \u0642\u0628\u0644\u06cc "),t.qZA(),t.TgZ(13,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.currectQuestionIndex=i.currectQuestionIndex+1)}),t._uU(14," \u0628\u0639\u062f\u06cc "),t.qZA()()()}if(2&n){const e=s.$implicit,o=s.index,i=t.oxw(2);t.Q6J("expanded",i.currectQuestionIndex===o),t.xp6(4),t.hij("",(o+1).toLocaleString("fa-IR"),"."),t.xp6(1),t.hij(" \xa0 ",e.text," "),t.xp6(1),t.Q6J("ngModel",e.selectedOption),t.xp6(1),t.Q6J("ngForOf",e.options),t.xp6(2),t.Q6J("disabled",null==e.selectedOption),t.xp6(2),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===i.attempt.answers.length-1)}}function B(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p",4),t._uU(2),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"\u067e\u0631\u0633\u0634\u200c\u0647\u0627\u06cc \u0622\u0632\u0645\u0648\u0646"),t.qZA(),t.TgZ(5,"mat-accordion"),t.YNc(6,q,15,8,"mat-expansion-panel",5),t.qZA(),t.TgZ(7,"div",6)(8,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.finishAttempt())}),t._uU(9,"\u067e\u0627\u06cc\u0627\u0646 \u0622\u0632\u0645\u0648\u0646"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name),t.xp6(4),t.Q6J("ngForOf",e.attempt.answers)("ngForTrackBy",e.identify)}}let $=(()=>{class n{constructor(e,o,i,r,u,m){this.attemptService=e,this.answerService=o,this.route=i,this.router=r,this.snackBar=u,this.alphabeticalNumbering=m,this.loading=!0,this.currectQuestionIndex=0,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.courseId=parseInt(e.get("courseId")),this.examId=parseInt(e.get("examId")),this.loadData(this.courseId,this.examId)}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe({next:i=>{this.attempt=i,this.loading=!1,i.attemptStatus!==g.I.inProgress&&this.router.navigate(["..",g.n[i.attemptStatus]],{relativeTo:this.route})},error:()=>{this.loading=!1}})}changeAnswer(e,o){e.selectedOption=o,this.answerService.putAnswer(this.courseId,this.examId,e.id,o).subscribe({error:i=>{var r,u;if(i instanceof f.UA){const m=null!==(u=null===(r=i.error)||void 0===r?void 0:r.message)&&void 0!==u?u:"\u062e\u0637\u0627 \u062f\u0631 \u062b\u0628\u062a \u067e\u0627\u0633\u062e\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(m)}}})}removeAnswer(e){e.selectedOption=null,this.answerService.deleteAnswer(this.courseId,this.examId,e.id).subscribe({error:o=>{var i,r;if(o instanceof f.UA){const u=null!==(r=null===(i=o.error)||void 0===i?void 0:i.message)&&void 0!==r?r:"\u062e\u0637\u0627 \u062f\u0631 \u062d\u0630\u0641 \u067e\u0627\u0633\u062e\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(u)}}})}finishAttempt(){this.attemptService.finishAttempt(this.courseId,this.examId).subscribe({next:()=>this.router.navigate(["../result"],{relativeTo:this.route}),error:e=>{var o,i;if(e instanceof f.UA){const r=null!==(i=null===(o=e.error)||void 0===o?void 0:o.message)&&void 0!==i?i:"\u062e\u0637\u0627 \u062f\u0631 \u067e\u0627\u06cc\u0627\u0646 \u0622\u0632\u0645\u0648\u0646\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(r)}}})}showError(e){this.snackBar.open(e,void 0,{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"warn-snackbar"})}identify(e,o){return o.id}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_),t.Y36(Z),t.Y36(p.gz),t.Y36(p.F0),t.Y36(w.ux),t.Y36(C.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attempting"]],decls:3,vars:3,consts:[["class","spinner-container",4,"ngIf"],[4,"ngIf"],[1,"spinner-container"],[1,"not-found","warn-text"],[1,"mat-display-2"],["cdkDrag","",3,"expanded","opened",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attempt-action-row"],["mat-raised-button","","color","accent",3,"click"],["cdkDrag","",3,"expanded","opened"],[1,"option-list",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","warn",3,"disabled","click"],["mat-button","","color","accent",3,"disabled","click"],["mat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(e,o){1&e&&(t.YNc(0,N,2,0,"div",0),t.YNc(1,k,5,0,"div",1),t.YNc(2,B,10,3,"div",1)),2&e&&(t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.attempt),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.attempt))},dependencies:[l.sg,l.O5,d.JJ,d.On,h.lW,b.Hw,c.pp,c.ib,c.VG,c.yz,c.yK,I.Zt,T.Ou,x.VQ,x.U0],styles:["[_nghost-%COMP%]{display:grid}.spinner-container[_ngcontent-%COMP%]{display:grid;align-items:center;justify-items:center}.not-found[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.warn-text[_ngcontent-%COMP%]{color:#f44336}.warn-text[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1rem}.attempt-action-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;margin-top:2rem}"]}),n})();function R(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"p",1),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4,"\u0634\u0645\u0627 \u0647\u0646\u0648\u0632 \u062f\u0631 \u0627\u06cc\u0646 \u0622\u0632\u0645\u0648\u0646 \u0634\u0631\u06a9\u062a \u0646\u06a9\u0631\u062f\u0647\u200c\u0627\u06cc\u062f."),t.qZA(),t.TgZ(5,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.beginAttempt())}),t._uU(6,"\u0634\u0631\u06a9\u062a \u062f\u0631 \u0622\u0632\u0645\u0648\u0646"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.attempt.name)}}const D=[{path:"",component:Y,children:[{path:"begin",component:(()=>{class n{constructor(e,o,i,r){this.attemptService=e,this.route=o,this.router=i,this.snackBar=r,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.route.paramMap.subscribe(e=>{this.loadData(parseInt(e.get("courseId")),parseInt(e.get("examId")))}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}loadData(e,o){this.attemptService.getAttempt(e,o).subscribe(i=>{this.attempt=i,i.attemptStatus!==g.I.notAttempted&&this.router.navigate(["..",g.n[i.attemptStatus]],{relativeTo:this.route})})}beginAttempt(){const e=parseInt(this.route.snapshot.paramMap.get("courseId")),o=parseInt(this.route.snapshot.paramMap.get("examId"));this.attemptService.beginAttempt(e,o).subscribe({next:()=>this.router.navigate(["../inprogress"],{relativeTo:this.route}),error:i=>{var r,u;if(i instanceof f.UA){const m=null!==(u=null===(r=i.error)||void 0===r?void 0:r.message)&&void 0!==u?u:"\u062e\u0637\u0627 \u062f\u0631 \u0634\u0631\u0648\u0639 \u0622\u0632\u0645\u0648\u0646\u060c \u0644\u0637\u0641\u0627\u064b \u0645\u062c\u062f\u062f\u0627\u064b \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f.";this.showError(m)}}})}showError(e){this.snackBar.open(e,void 0,{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"warn-snackbar"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_),t.Y36(p.gz),t.Y36(p.F0),t.Y36(w.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-begin-attempt"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"mat-display-2"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,R,7,1,"div",0),2&e&&t.Q6J("ngIf",o.attempt)},dependencies:[l.O5,h.lW]}),n})()},{path:"inprogress",component:$},{path:"result",component:S}]}];let E=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(D),p.Bz]}),n})(),G=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[_,Z],imports:[l.ez,d.u5,d.UX,y.q,E]}),n})()}}]);